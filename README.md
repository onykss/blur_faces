## **Face Blur Video Processor**

Проект предназначен для обработки видео с помощью модели распознавания лиц. Каждый кадр видео анализируется моделью, чтобы выделить лица и замазать их. Проект написан на Python и использует библиотеки `OpenCV`, `Pillow`, и PyTorch.

---

### **Описание проекта**

1. **Основная цель**:
   - Обработка видеофайлов любого формата.
   - Распознавание лиц в каждом кадре.
   - Замазывание выделенных лиц (например, размытие или черный прямоугольник).
   - Веса модели можно загрузить по ссылке: `https://www.dropbox.com/scl/fi/20qmjwffx5c4fpbzl169s/model_weights.pth?rlkey=yfkce0dc16rhiw4h57ch7xr1l&st=w6etrt4t&dl=0`

2. **Структура проекта**:
   ```
   ├── input
   │   └── [входные видеофайлы]
   ├── model
   │   ├── model_weights.pth  # Веса обученной модели
   │   └── training_notebook.ipynb  # Блокнот с информацией об обучении модели
   ├── output
   │   └── [выходные видеофайлы]
   ├── frame_processor.py  # Модуль для обработки каждого кадра
   ├── main.py  # Основной скрипт для запуска программы
   ├── object_detector.py  # Модуль для детектирования объектов (лиц)
   ├── object_masker.py  # Модуль для маскирования объектов
   ├── requirements.txt  # Список зависимостей
   └── video_processor.py  # Модуль для работы с видеофайлами
   ```

3. **Функциональность**:
   - **Модель распознавания лиц**: Используется обученная с нуля модель для выделения лиц на каждом кадре.
   - **Обработка видео**: Каждый кадр проходит через модель, и выделенные лица замазываются.
   - **Логирование**: Процесс обработки записывается в файл `blur_face.log`.

4. **Текущие ограничения**:
   - Модель пока сыровата и может допускать ошибки при распознавании лиц.
   - Иногда возникают артефакты при замаскировании.

5. **Будущие улучшения**:
   - Добавление рекуррентной структуры для более точного распознавания лиц.
   - Улучшение качества маскирования.
   - Поддержка дополнительных параметров для настройки уровня размытия или типа маскирования.

---

### **Установка и использование**

#### **1. Клонирование репозитория**
```bash
git clone https://github.com/yourusername/face-blur-video-processor.git
cd face-blur-video-processor
```

#### **2. Установка зависимостей**
Используйте `requirements.txt` для установки необходимых библиотек:
```bash
pip install -r requirements.txt
```

#### **3. Запуск программы**
Для обработки видеофайла выполните следующую команду:
```bash
python main.py --filename filename.mp4
```
- **Пример**:
  ```bash
  python main.py --filename input/video.mp4
  ```
- Результат будет сохранен в папку `output`.

#### **4. Параметры**
- `--filename`: Путь к входному видеофайлу.
- Дополнительные параметры могут быть добавлены в будущем.

---

### **Структура проекта**

#### **Папка `input`**
Содержит исходные видеофайлы для обработки.

#### **Папка `model`**
- `model_weights.pth`: Веса обученной модели.
- `training_notebook.ipynb`: Блокнот Jupyter Notebook с информацией об обучении модели.

#### **Папка `output`**
- `blur_face.log`: Лог-файл процесса обработки.
- Результаты обработки будут сохранены в этой папке.

#### **Файлы Python**
- **`main.py`**: Основной скрипт для запуска программы.
- **`frame_processor.py`**: Модуль для обработки каждого кадра.
- **`object_detector.py`**: Модуль для детектирования лиц на кадре.
- **`object_masker.py`**: Модуль для маскирования выделенных лиц.
- **`video_processor.py`**: Модуль для чтения и записи видеофайлов.

#### **requirements.txt**
Список всех необходимых библиотек для работы проекта.

---

### **Поддержка и обратная связь**

Если вы обнаружили ошибки или хотите предложить улучшения, откройте issue в репозитории GitHub или свяжитесь со мной напрямую.

---

### **Лицензия**
MIT License

---

### **Зависимости**
- OpenCV
- Pillow
- PyTorch
- NumPy
- Other dependencies listed in `requirements.txt`
